import Data.List
import Data.Bits

-- "PONDERTHIS2013ABCBCA3102SIHTREDNOPFGJKLMQUVWXYZ4554ZYXWVUQMLKJGFUQMLKJGF54ZYXWVVWXYZ45FGJKLMQUHTREDNOPBCA3102SIIS2013ABCPONDERTH54ZYXWVUQMLKJGFFGJKLMQUVWXYZ45BCA3102SIHTREDNOPPONDERTHIS2013ABCIS2013ABCPONDERTHHTREDNOPBCA3102SIVWXYZ45FGJKLMQUUQMLKJGF54ZYXWVVWXYZ45FGJKLMQUUQMLKJGF54ZYXWVIS2013ABCPONDERTHHTREDNOPBCA3102SIBCA3102SIHTREDNOPPONDERTHIS2013ABC54ZYXWVUQMLKJGFFGJKLMQUVWXYZ45HTREDNOPBCA3102SIIS2013ABCPONDERTHUQMLKJGF54ZYXWVVWXYZ45FGJKLMQUFGJKLMQUVWXYZ4554ZYXWVUQMLKJGFPONDERTHIS2013ABCBCA3102SIHTREDNOP"
--
-- map snd . sort . concat $ zipWith (\x y-> map (flip (,) x) y) "PONDERTHIS2013ABCFGJKLMQUVWXYZ45" (map (\ x -> map (xor x) [0,31,103,120,175,176,200,215,296,311,335,336,391,408,480,511]) ([0..16]++[32..48]))
-- "PONDERTHIS2013ABCBCA3102SIHTREDNOPFGJKLMQUVWXYZ4554ZYXWVUQMLKJGFUQMLKJGF54ZYXWVVWXYZ45FGJKLMQUHTREDNOPBCA3102SIIS2013ABCPONDERTH54ZYXWVUQMLKJGFFGJKLMQUVWXYZ45BCA3102SIHTREDNOPPONDERTHIS2013ABCIS2013ABCPONDERTHHTREDNOPBCA3102SIVWXYZ45FGJKLMQUUQMLKJGF54ZYXWVVWXYZ45FGJKLMQUUQMLKJGF54ZYXWVIS2013ABCPONDERTHHTREDNOPBCA3102SIBCA3102SIHTREDNOPPONDERTHIS2013ABC54ZYXWVUQMLKJGFFGJKLMQUVWXYZ45HTREDNOPBCA3102SIIS2013ABCPONDERTHUQMLKJGF54ZYXWVVWXYZ45FGJKLMQUFGJKLMQUVWXYZ4554ZYXWVUQMLKJGFPONDERTHIS2013ABCBCA3102SIHTREDNOP"
--
-- map snd . sort . concat $ zipWith (\x y-> map (flip (,) x) y) "LUCKYPONDERTHIS2013ABFGJMQVWXZ45" (map (\ x -> map (xor x) [0,47,87,120,159,176,200,231,280,311,335,352,391,424,464,511]) ([0..31]))

ones x = length . filter (0/=) . map ((.&.) x . shiftL 1) $ take (bitSize x) [0..]

distance x y = ones (x `xor` y)

l = "LUCKYPONDERTHIS2013ABFGJMQVWXZ452SIHTREDNOPYKCUL54ZXWVQMJGFBA310JGFBA31054ZXWVQMNOPYKCUL2SIHTREDMQVWXZ45013ABFGJDERTHIS2LUCKYPON54ZXWVQMJGFBA3102SIHTREDNOPYKCUL013ABFGJMQVWXZ45LUCKYPONDERTHIS2DERTHIS2LUCKYPONMQVWXZ45013ABFGJNOPYKCUL2SIHTREDJGFBA31054ZXWVQMMQVWXZ45013ABFGJDERTHIS2LUCKYPONJGFBA31054ZXWVQMNOPYKCUL2SIHTRED2SIHTREDNOPYKCUL54ZXWVQMJGFBA310LUCKYPONDERTHIS2013ABFGJMQVWXZ45NOPYKCUL2SIHTREDJGFBA31054ZXWVQMDERTHIS2LUCKYPONMQVWXZ45013ABFGJ013ABFGJMQVWXZ45LUCKYPONDERTHIS254ZXWVQMJGFBA3102SIHTREDNOPYKCUL"

a = nub $ map (\n -> id . nub . sort . map snd . filter ((2>=) . distance n . fst) $ zip [0..] l) [0..511::Int]


-- Possible solutions
-- 0,31,103,120,175,176,200,215,296,311,335,336,391,408,480,511
-- 356,379,132,155,252,227,259,284,76,83,43,52,428,435,459,468
-- 0,55,79,120,152,175,215,224,287,296,336,359,391,432,456,511
-- 0,47,87,120,159,176,200,231,280,311,335,352,391,424,464,511
